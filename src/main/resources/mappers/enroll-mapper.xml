<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="enrollMapper"> 
	<insert id="insertUser">
		insert into users
		values(SEQ_USERS_NO.nextval, #{usersId}, #{usersPw}, #{usersName}, #{nickName}, #{email}, #{phone}, 
				sysdate, default, default, default, default, default, default, default, default, default)
	</insert>
	
	<select id="login" resultMap="usersResultSet">
		select *
		from users
		where users_id = #{usersId} and status = 'Y'
	</select>
	
	<resultMap type="kh.finalproj.hollosekki.enroll.model.vo.Users" id="usersResultSet">
		<id column="USERS_NO" property="usersNo"/>
		<result column="USERS_ID" property="usersId"/>
		<result column="USERS_PW" property="usersPw"/>
		<result column="USERS_NAME" property="usersName"/>
		<result column="NICKNAME" property="nickName"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE" property="phone"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="EXIT_DATE" property="eixtDate"/>
		<result column="STATUS" property="status"/>
		<result column="CHECK_DAY" property="checkDay"/>
		<result column="POINT" property="point"/>
		<result column="IS_ADMIN" property="isAdmin"/>
		<result column="ATTENDANCE_DATE" property="attendanceDate"/>
		<result column="ATTENDANCE_DAY" property="attendanceDay"/>
		<result column="USERS_ADDRESS" property="usersAddress"/>
		<result column="USERS_SELFINTRO" property="usersSelfIntro"/>
	</resultMap>
	
	<select id="checkId" resultType="_int">
		select count(*)
		from users
		where users_id = #{id}
	</select>
	
	<select id="checkNickName" resultType="_int">
		select count(*)
		from users
		where nickName = #{nickName}
	</select>
	
	<select id="checkEmail" resultType="_int">
		select count(*)
		from users
		where email = #{email}
	</select>
	
	<select id="findIdResult" resultMap="usersResultSet">
		select *
		from users
		where users_name = #{name} and email = #{email}
	</select>
	
	<select id="findPwdCheck" resultType="_int">
		select count(*)
		from users
		where users_id = #{id} and email = #{email}
	</select>
	
	<update id="updatePwdResult">
		update users set users_pw = #{usersPwd} where users_id=#{id}
	</update>
	
	<select id="socialLogin" resultMap="socialResultSet">
		select *
		from social_login
		where social_id=#{id}
	</select>
	
	<resultMap type="SocialLogin" id="socialResultSet">
		<id column="SOCIAL_ID" property="socialId"/>
		<result column="SOCIAL_PROFILE_IMG" property="socialProfileImg"/>
	</resultMap>
	
	<insert id="socialInsertUser">
		insert into social_login
		values(#{socialId}, #{socialProfileImg})
	</insert>
	
	<select id="socialLoginUpdate" resultMap="usersResultSet">
		select *
		from users
		where users_id = #{id} and status = 'Y'
	</select>
	
	<update id="socialInfoUpdate">
		update social_login set social_profile_img = #{profileImg}
		where social_id=#{id}
	</update>
	
	<update id="socialInfoUpdate2">
		update users set users_name = #{name}, nickname = #{name}
		where users_id = #{id}
	</update>
	
	<select id="recipeList" resultMap="recipeResultSet">
		select *
		from recipe
		where users_no=#{usersNo} and recipe_status = 'Y'
		order by food_no desc
	</select>
	
	<resultMap type="Recipe" id="recipeResultSet">
		<id column="food_no" property="foodNo"/>
		<result column="USERS_NO" property="usersNo"/>
		<result column="RECIPE_NAME" property="recipeName"/>
		<result column="CATEGORY_INGREDIENT" property="categoryIngredient"/>
		<result column="CATEGORY_SITUATION" property="categorySituation"/>
		<result column="CATEGORY_TYPE" property="categoryType"/>
		<result column="RECIPE_DIFFICULTY" property="recipeDifficulty"/>
		<result column="RECIPE_TIME" property="recipeTime"/>
		<result column="RECIPE_CONTENT" property="recipeContent"/>
		<result column="RECIPE_COUNT" property="recipeCount"/>
		<result column="RECIPE_CREATE_DATE" property="recipeCreateDate"/>
		<result column="RECIPE_MODIFY_DATE" property="recipeModifyDate"/>
		<result column="RECIPE_STATUS" property="recipeStatus"/>
	</resultMap>
	
	<select id="recipeImageList" resultMap="imageResultSet">
		select *
		from image
		where image_divide_no = ${ foodNo } and image_level = 0
		order by image_no desc
	</select>
	
	<resultMap type="Image" id="imageResultSet">
		<id column="IMAGE_NO" property="imageNo"/>
		<result column="IMAGE_DIVIDE_NO" property="imageDivideNo"/>
		<result column="IMAGE_TYPE" property="imageType"/>
		<result column="IMAGE_ORIGINALNAME" property="imageOriginalName"/>
		<result column="IMAGE_RENAMENAME" property="imageRenameName"/>
		<result column="IMAGE_PATH" property="imagePath"/>
		<result column="IMAGE_LEVEL" property="imageLevel"/>
	</resultMap>
	
	<select id="bookMarkList" resultMap="bookmarkResultSet">
		select *
		from bookmark
		where users_no = ${usersNo}
	</select>
	
	<resultMap type="BookMark" id="bookmarkResultSet">
		<id column="BOOKMARK_NO" property="bookmarkNo"></id>
		<result column="USERS_NO" property="usersNo"/>
		<result column="DIVISION_NO" property="divisionNo"/>
		<result column="NUMBER_TYPE" property="numberType"/>
	</resultMap>
	
	<select id="menuList" resultMap="menuResultSet">
		select *
		from menu
		order by product_no desc
	</select>
	
	<resultMap type="Menu" id="menuResultSet">
		<id column="PRODUCT_NO" property="productNo"/>
		<result column="MENU_NAME" property="menuName"/>
		<result column="MENU_TYPE" property="menuType"/>
		<result column="MENU_CONTENT" property="menuContent"/>
	</resultMap>
</mapper>